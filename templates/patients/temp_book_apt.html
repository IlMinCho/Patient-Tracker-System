{% extends "core/base.html" %}

{% block title %}Book Appointments{% endblock %}


{% block content %}
    <div class="container my-5">
        <div>
            <h1 class="display-4 fw-bold">Search Doctor</h1>
        </div>

        <form method="post" action="{{ url_for('book_appointment') }}">
            <div class="form-row align-items-center">
                <div class="col-auto">
                    <label for="first_name" class="sr-only">First Name</label>
                    <input type="text" class="form-control mb-2" id="first_name" name="first_name" placeholder="First Name">
                </div>
                <div class="col-auto">
                    <label for="last_name" class="sr-only">Last Name</label>
                    <input type="text" class="form-control mb-2" id="last_name" name="last_name" placeholder="Last Name">
                </div>
                <div class="col-auto">
                    <label for="specialization" class="sr-only">Specialization</label>
                    <input type="text" class="form-control mb-2" id="specialization" name="specialization" placeholder="Specialization">
                </div>
                <div class="col-auto">
                    <button type="submit" class="btn btn-primary mb-2">Search</button>
                </div>
            </div>
        </form>

        {% if doctors %}
            <!-- Display search results -->
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Doctor Name</th>
                            <th>Email</th>
                            <th>Specialization</th>
                            <th>Years of Experience</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            {% for doctor in doctors %}
                                <tr>
                                    <td>{{ doctor.name }}</td>
                                    <td>{{ doctor.email }}</td>
                                    <td>{{ doctor.specialization }}</td>
                                    <td>{{ doctor.experience }}</td>
                                </tr>
                            {% endfor %}
                        </tr>
                    </tbody>
                </table>
                <button class="btn btn-secondary" onclick="closeTable()">Close</button>
            </div>
            <script>
                function closeTable() {
                    // Add JavaScript logic to close or hide the table
                    document.querySelector('.table-container').style.display = 'none';
                }
            </script>

        {% endif %}

        <div>
            <h1 class="display-4 fw-bold">Book Doctor</h1>
        </div>

        <form method="post" action="{{ url_for('book_appointment') }}">
            <div class="form-row align-items-center">
                <div class="col-auto">
                    <label for="apt_id" class="sr-only">Appointment Number</label>
                    <input type="text" class="form-control mb-2" id="apt_id" name="apt_id" placeholder="Appointment Number">
                </div>
                <div class="col-auto">
                    <label for="doctor_name" class="sr-only">Doctor Name</label>
                    <input type="text" class="form-control mb-2" id="doctor_name" name="doctor_name" placeholder="Doctor Name">
                </div>
                <div class="col-auto">
                    <label for="date" class="sr-only">Appointment Date</label>
                    <input type="text" class="form-control mb-2" id="date" name="date" placeholder="MM/DD/YYYY">
                </div>
                <div class="col-auto">
                    <label for="time" class="sr-only">Appointment Time</label>
                    <input type="text" class="form-control mb-2" id="time" name="time" placeholder="Appointment Time">
                </div>
                <div class="col-auto">
                    <label for="reason" class="sr-only">Reason to Visit</label>
                    <input type="text" class="form-control mb-2" id="reason" name="reason" placeholder="Reason to Visit">
                </div>
                <div class="col-auto">
                    <button type="submit" class="btn btn-primary mb-2">Book</button>
                </div>
            </div>
        </form>

        <div id="flash-messages">
            {% for message in get_flashed_messages() %}
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            {% endfor %}
        </div>
    
        <!-- Custom script to auto-close flash messages after a few seconds -->
        <script>
            // Auto-close flash messages after 5 seconds
            setTimeout(function() {
                $('#flash-messages .alert').alert('close');
            }, 5000);
        </script>
        
    </div>
{% endblock %}


